

      // p5 ppm visualization
      [var name:"animate2" value:false /]
      [p5Component
        ppm: viz2ppm
        animate: animate2
        onEnterView: `animate2 = true`
        onExitViewFully: `animate2 = false`
        className: "center"
        isVisible: partOneCompleted
        sketch:`(p, parent) => {

          // visualizing ppm at different levels
          // modifying code by Daniel Shiffman
          // http://codingtra.in
          // http://patreon.com/codingtrain
          // Code for: https://youtu.be/17WoOqgXsRM

          let stars, volume, depth;
          let zoom = 6;
          let speed = 10;
          let concentration = getCO2Level(co2, birthYear);

          function init() {
            depth = 2 * p.width;
            p.fill(40, 32, 68);
            p.textSize(12);
            p.textAlign(p.LEFT, p.CENTER);
            p.noStroke();

            volume = p.round((2*p.width) * (2*p.height) * depth / p.pow(zoom,3));
            let numStars = p.round(volume * concentration / 1000000);

            stars = [];
            for (let i = 0; i < numStars; i++) {
              stars.push(new Star());
            }
          }

          p.setup = function() {
            p.createCanvas(400, 400);
            p.noLoop();
            init();
          };

          p.draw = function() {
            p.background(250);
            p.text(concentration + ' ppm', 10, p.height - 10);

            p.translate(p.width / 2, p.height / 2);

            for (let star of stars) {
              star.update();
              star.show();
            }

          };

          function Star() {
            this.x = p.random(-p.width, p.width);
            this.y = p.random(-p.height, p.height);
            this.z = p.random(depth);

            this.update = function() {

              this.z = this.z - speed;

              if (this.z < 1) {
                this.z = depth;
                this.x = p.random(-p.width, p.width);
                this.y = p.random(-p.height, p.height);
              }
            };

            this.show = function() {
              p.circle(p.map(this.x / this.z, 0, 1, 0, p.width),
                     p.map(this.y / this.z, 0, 1, 0, p.height),
                     p.map(this.z, 1, depth, zoom, 1));
            };
          }

          p.windowResized = function() {
          }

          p.onUpdate = function(props, oldProps) {
            if (props.animate !== oldProps.animate) {
              if (props.animate) {
                //console.log('starting animation');
                p.loop();
              } else {
                //console.log('pausing animation');
                p.noLoop();
              }
            }
            if (props.ppm !== oldProps.ppm) {
              concentration = props.ppm;
              init();
            }
          };

        }

        `
        /]

      [br/]
      [div className:"buttonwrapper"]

        [Button onClick:`viz2ppm = 280`]
          280 ppm (Pre-Industrial Levels)
        [/Button]

        [Button onClick:`viz2ppm = getCO2Level(co2, birthYear)`]
          [Display value:`getCO2Level(co2, birthYear)` format:"d" /] ppm ([Display value:`birthYear` format:"d" /] levels)
        [/Button]

        [Button onClick:`viz2ppm = 412`]
          412 ppm (2019 Levels)
        [/Button]

      [/div]
      [br/]







# Testing Data Load
[data name:"co2" source:"CO2.csv" /]

Data length: [Display value:`co2.length` format:"d"/]
[br/]
First row: [Display value:`co2[0]` format:"d"/]
[br/]
Last row: [Display value:`co2[co2.length - 1]` format:"d"/]
[br/]
CO2 in 2019: [Display value:`getCO2Level(co2, '2019')` format:"d"/] ppm
[br/]
CO2 in 1985: [Display value:`getCO2Level(co2, '1985')` format:"d"/] ppm
[br/]
CO2 in 1760: [Display value:`getCO2Level(co2, '1760')` format:"d"/] ppm
[br/]
Pre-industrial CO2 levels: [280 ppm](https://www.esrl.noaa.gov/gmd/ccgg/trends/weekly.html)
[br/]






[var name:'data' value:`[{
            x: [1, 2, 3, 4],
            y: [12, 9, 15, 12],
            mode: 'lines+markers',
            type: 'scatter'
          }]`
/]

[div fullWidth:true ]
  [PlotlyComponent
    data: `[{
              x: co2.map(e => e.year),
              y: co2.map(e => e.ppm),
              mode: 'lines',
              type: 'scatter'
            }]`
    layout: `{
              title: 'CO2 vs time',
              font: {size: 18},
              xaxis: {
                title: 'Year'
              },
              yaxis: {
                title: 'CO2 Level (parts per million)'
              }
              }`
    config: `{responsive: true}`
  /]
[/div]




  [var name:"redrawCount" value:0 /]
  [ReactPlotlyComponent
        isVisible:birthYearSelected
        redrawCount: redrawCount
        data:`
          [{
            x: [1, 2, 3],
            y: [2, 6, 3],
            type: 'scatter',
            mode: 'lines+markers',
            marker: {color: 'red'},
          }]`
        layout:`{
          title: 'A Fancy Plot',
          autosize: true}`
    /]

    [Button onClick:`redrawCount += 1`]
      Redraw Graph.
    [/Button]

 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam tortor nunc, elementum eu ex vitae, lobortis fringilla ligula. Nunc sed nisl auctor dolor viverra dapibus sit amet et magna. Phasellus vestibulum dictum facilisis. Phasellus ut suscipit justo, ac vulputate nisi. Proin eu leo non nunc viverra egestas vitae eu augue. Vestibulum non massa in nulla interdum viverra. Vestibulum sit amet libero iaculis, maximus magna quis, dapibus lacus.

 [data name:"carbonEmissions" source:"carbon-emissions.csv" /]

 [Table data:carbonEmissions columns:`['Year', 'Total']` defaultPageSize:10 /]
 [br/]

 Aenean eros sem, varius quis erat sit amet, pulvinar aliquet diam. Etiam et vestibulum justo. Pellentesque commodo tristique metus at tempor. Donec cursus volutpat arcu. Etiam eget nisl mi. Cras malesuada tortor non diam auctor, vel porta tellus malesuada. Aliquam erat volutpat. Sed ut venenatis quam, sed elementum turpis. Duis bibendum consequat finibus.

[var name:"clicks" value:0 /]
[CustomComponent style:`{cursor: 'pointer'}` clickCount:clicks /]

[Caption]
You've clicked on the component above [Display value:clicks format:"d" /] times.
[/Caption]

Fusce aliquam fermentum ex. Nullam mi sem, varius rutrum diam vitae, laoreet malesuada quam. Fusce sodales nibh ut finibus condimentum. Donec eget risus ut ipsum sodales commodo. Cras ullamcorper augue velit, at finibus diam mattis vel. Ut lobortis velit eget dolor dictum tincidunt. Morbi rhoncus vehicula sapien sit amet tempor. Aliquam blandit nisi eu enim fermentum, ac varius neque venenatis. Nullam in nisi at ante mollis tempus. Nullam congue finibus nisl eu finibus. Donec porttitor non ipsum et scelerisque. In in turpis elementum justo rhoncus varius at in metus. Aliquam eget dui mi. Donec non tortor sit amet massa porttitor aliquam tristique ut metus.

[var name:"updateCount" value:0 /]

[CustomD3Component updateCount:updateCount /]

[Button onClick:`updateCount += 1`]
  Update.
[/Button]

Integer viverra neque ut tristique laoreet. Vestibulum malesuada molestie sapien, sed auctor magna pellentesque nec. Nunc cursus tristique nisl. Donec aliquet felis nec mollis commodo. Ut dapibus blandit quam. Fusce tellus neque, ullamcorper quis magna ac, posuere pretium leo. Sed quam augue, porttitor eget pharetra non, tincidunt in mi. Suspendisse orci dui, vehicula ac aliquam non, iaculis a lacus. Fusce a nisi gravida, vulputate nibh quis, blandit ante. Nunc fringilla risus vitae ornare convallis. Sed rhoncus dolor risus, et pulvinar neque maximus non. Nullam tempor porta risus, et sagittis felis luctus at. Vestibulum a mi eget sapien auctor malesuada egestas vitae orci.

Quisque non laoreet dui. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nunc euismod consectetur odio, at facilisis leo congue at. Nam vitae est nunc. Ut consequat molestie erat id interdum. Quisque rhoncus, tortor a accumsan aliquet, augue odio porta lorem, vulputate egestas felis ante vitae neque. Proin nulla sapien, interdum et lorem quis, semper facilisis sapien. Donec erat sem, interdum id efficitur eget, efficitur sit amet eros. Aenean at nisl eu dui maximus convallis. Etiam varius odio vel laoreet maximus. Duis ac lacus lorem. Aliquam rutrum dapibus sapien non porttitor.


[AuthorBio]

[b][a href:""]Your Name[/a][/b] is _TK insert bio here_.

Edited by TK editor list.
[/AuthorBio]

[NextArticle slug:parametricSlug fullWidth:true /]

[Footer fullWidth:true /]

// Uncomment before pub
// [Analytics google:"UA-139053456-1" tag:parametricSlug /]